<!DOCTYPE html><html lang="en"><head>
<link rel="dns-prefetch" href="//www.googletagmanager.com">
<link rel="dns-prefetch" href="//blog.larapulse.com">
<link rel="dns-prefetch" href="//larapulse.com">
<link rel="dns-prefetch" href="//api.larapulse.com">
<link rel="dns-prefetch" href="//github.com">
<link rel="dns-prefetch" href="//$host$request_uri">
<link rel="dns-prefetch" href="//habr.com">
<link rel="dns-prefetch" href="//weakdh.org">
<link rel="dns-prefetch" href="//www.html5rocks.com">
<link rel="dns-prefetch" href="//www.ssllabs.com">
<link rel="dns-prefetch" href="//podgornyy.rocks">
<link rel="dns-prefetch" href="//louisbarranqueiro.github.io">
<link rel="dns-prefetch" href="//www.youtube.com">
<link rel="dns-prefetch" href="//www.instagram.com">
<link rel="dns-prefetch" href="//www.facebook.com">
<link rel="dns-prefetch" href="//www.linkedin.com">
<link rel="dns-prefetch" href="//twitter.com">
<link rel="dns-prefetch" href="//t.me"><script async src=https://www.googletagmanager.com/gtag/js?id=UA-122807654-1></script><script> window.dataLayer = window.dataLayer || []; function gtag(){ dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-122807654-2'); </script><title>Obtaining security class A+ with nginx and https - Network | Larapulse Technology Blog</title><meta charset=UTF-8><meta name=robots content="index,follow"><meta name=viewport content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=yes"><meta name=keywords content="larapulse,technology,blog,article,network,tutorial,nginx,security,https,ssl-certificate,ssl,tsl,http,server,web,cipher,system-administration,session"><meta name=description content="Learn how to configure HTTPS with nginx to get an A+ score when checking in SSL Labs and how secure yourself against the latest bugs by SSL encryption."><meta name=subject content="Obtaining security class A+ with nginx and https - Network | Larapulse Technology Blog"><meta name=author content="Sergey Podgorny"><meta name=publisher content="Larapulse Technology"><meta name=language content="en_GB"><meta name=copyright content="Larapulse Technology"><meta name=format-detection content="telephone=no"><meta name=topic content="Obtaining security class A+ with nginx and https"><meta name=page-topic content="Obtaining security class A+ with nginx and https"><meta name=designer content="Louis Barranqueiro"><meta name=owner content="Sergey Podgornyy, sergey.podgornyy@yahoo.de"><meta name=url content="/"><meta name=identifier-url content="/"><meta name=pagename content="Obtaining security class A+ with nginx and https - Network | Larapulse Technology Blog"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=medium content="blog"><meta name=pageKey content="blog::article.show.16"><meta name=google-site-verification content="3WYVb1kIZ6bM3SSFHxn5vjD9YgSr11qmrilWNnEJtX8"><meta name=msapplication-TileImage content="/static/images/logo_400x400.jpg"><meta name=msapplication-TileColor content="#F55338"><meta name=twitter:card content="summary"><meta name=twitter:title content="Obtaining security class A+ with nginx and https - Network | Larapulse Technology Blog"><meta name=twitter:description content="Learn how to configure HTTPS with nginx to get an A+ score when checking in SSL Labs and how secure yourself against the latest bugs by SSL encryption."><meta name=twitter:image content="/files/original/images/05/f6/05f66a64d9c3decb400b494d6db65144d68e4c4b.png"><meta name=twitter:site content="@LarapulseT"><meta property="fb:app_id" content="321394058628025"><meta property="og:title" content="Obtaining security class A+ with nginx and https"><meta property="og:url" content="/network/security-class-a-with-nginx-https"><meta property="og:locale" content="en_GB"><meta property="og:description" content="Learn how to configure HTTPS with nginx to get an A+ score when checking in SSL Labs and how secure yourself against the latest bugs by SSL encryption."><meta property="og:site_name" content="Larapulse Technology Blog"><meta property="og:type" content="article"><meta property="og:image" content="/files/original/images/05/f6/05f66a64d9c3decb400b494d6db65144d68e4c4b.png"><meta property="og:image:url" content="/files/original/images/05/f6/05f66a64d9c3decb400b494d6db65144d68e4c4b.png"><meta property="og:image:secure_url" content="/files/original/images/05/f6/05f66a64d9c3decb400b494d6db65144d68e4c4b.png"><meta property="og:image:type" content="image/png"><meta property="og:image" content="/files/original/images/cd/6c/cd6c845cee7e3f8e02fa85a747bf28f0cbfa79ae.png"><meta property="og:image:url" content="/files/original/images/cd/6c/cd6c845cee7e3f8e02fa85a747bf28f0cbfa79ae.png"><meta property="og:image:secure_url" content="/files/original/images/cd/6c/cd6c845cee7e3f8e02fa85a747bf28f0cbfa79ae.png"><meta property="og:image:type" content="image/png"><meta property="article:published_time" content="2018-09-07T22:25:09+00:00"><meta property="article:modified_time" content="2018-09-07T22:25:11+00:00"><meta property="article:author" content="Sergey Podgorny"><meta property="article:section" content="Network"><meta property="article:tag" content=""><meta property="profile:first_name" content="Sergey"><meta property="profile:last_name" content="Podgorny"><meta property="profile:username" content="sergey.podgornyy"><meta http-equiv="Content-type" content="text/html; charset=UTF-8"><meta http-equiv="Content-language" content="en_GB"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><link rel="icon" href="/static/images/favicon.ico" ><link rel="shortcut icon" href="/static/images/favicon.ico" ><link rel="icon" href="/static/images/logo_192x192.jpg" sizes="192x192" ><link rel="apple-touch-icon" href="/static/images/logo_180x180.jpg" sizes="180x180" ><link rel="apple-touch-icon" href="/static/images/logo_152x152.jpg" sizes="152x152" ><link rel="apple-touch-icon" href="/static/images/logo_120x120.jpg" sizes="120x120" ><link rel="apple-touch-icon" href="/static/images/logo_76x76.jpg" sizes="76x76" ><link rel="apple-touch-icon" href="/static/images/logo_57x57.jpg" sizes="57x57" ><link rel="index" href="/" title="Larapulse Technology" ><link rel="help" href="/faq" title="FAQ" ><link rel="publisher" href="/" ><link rel="image_src" href="/files/original/images/05/f6/05f66a64d9c3decb400b494d6db65144d68e4c4b.png" ><link rel="canonical" href="/network/security-class-a-with-nginx-https" ><link rel="alternate" href="/feed/atom.xml" type=application/atom+xml title="Atom 0.3" ><link rel="alternate" href="/feed/rss.xml" type=application/rss+xml title="RSS" ><link media="all" type=text/css rel="stylesheet" href="/assets/main.4065552450.css"><style> .badge.chip-security-class-a-with-nginx-https { background-color: #2d5cab; } @media only screen and (max-width: 479px) { .post-group .post.item .badge.chip-security-class-a-with-nginx-https { border: 2px solid #2d5cab !important; background-color: #fff; padding: 3px 16px; } .post-group .post.item .badge.chip-security-class-a-with-nginx-https a { color: #2d5cab !important; } } </style><!--[if lt IE 9]><script src=//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.4065552450.js></script><script src=//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.4065552450.js></script><![endif]--><script>var apiUrl = 'https://api.larapulse.com';</script>
<style>.page_speed_813892850{ display: block; } .page_speed_501768847{ margin-bottom: 0; display: none } .page_speed_497134828{ display: none; } .page_speed_536648213{ top: -420px; display: none; }</style>
</head><body><div id="blog" class="page_speed_813892850"><header id="header" data-behavior="1"><i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i><h3 class="header-title"><a class="header-title-link" href="/">Larapulse Blog</a></h3><a class="header-right-picture" href="/#about"><img class="header-picture" src=/assets/logo_30x30.jpg width=30px height=30px></a></header><nav id="sidebar" data-behavior="1"><div class="sidebar-profile"><a href="/#about"><img class="sidebar-profile-picture" src=/assets/logo_90x90.jpg width=90px height=90px></a><span class="sidebar-profile-name">Larapulse Blog</span></div><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link " href="/"><i class="sidebar-button-icon fa fa-lg fa-home"></i><span class="sidebar-button-desc">Home</span></a></li><li class="sidebar-button"><a class="sidebar-button-link " href="/announcements"><i class="sidebar-button-icon fa fa-lg fa-bell"></i><span class="sidebar-button-desc">Announcements</span></a></li><li class="sidebar-button"><a class="sidebar-button-link " href="/#about"><i class="sidebar-button-icon fa fa-lg fa-question"></i><span class="sidebar-button-desc">About</span></a></li></ul><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link " href="/faq"><i class="sidebar-button-icon fa fa-lg fa-comments"></i><span class="sidebar-button-desc">FAQ</span></a></li><li class="sidebar-button"><a class="sidebar-button-link " href="https://github.com/larapulse" target="_blank"><i class="sidebar-button-icon fa fa-lg fa-github"></i><span class="sidebar-button-desc">GitHub</span></a></li></ul><ul class="sidebar-buttons"></ul></nav><div id="main" data-behavior="1"><section class="main-content-wrap"><article class="post article"><div class="post-header"><h1 class="post-title text-center"> Obtaining security class A+ with nginx and https </h1><div class="post-meta text-center"><p class="published-line"><time content="Fri, Sep 7, 2018 10:25 PM"> Sep 7, 2018 </time> by Sergey Podgorny</p><span class="badge chip chip-security-class-a-with-nginx-https"><a href="/network"> Network </a></span><span class="badge complexity-badge complexity-8"> Complexity: High</span><span class="tags"><a href="#">#tutorial</a><a href="#">#nginx</a><a href="#">#security</a><a href="#">#https</a><a href="#">#ssl-certificate</a><a href="#">#network</a><a href="#">#ssl</a><a href="#">#tsl</a><a href="#">#http</a><a href="#">#server</a><a href="#">#web</a><a href="#">#cipher</a><a href="#">#system-administration</a><a href="#">#session</a></span></div></div><br><div class="breadcrumb non-printable"><a href="/categories">All categories</a> &raquo; <a href="/network">Network</a> &raquo; <span class="inactive">Obtaining security class A+ with nginx and https</span></div><hr><div class="post-content printable" onload="prettyPrint();"><p>If your leave any of your pages insecure, all of your pages are insecure, because anyone in-between your users and you (like other people in a coffee shop) can easily intercept all of the traffic and replace <code>https://</code> links with <code>http://</code> links. They can then do whatever they want with any page on your site. If your site uses authentication then it must also use HTTPS for the life of the session. To secure our website we will force usage of HTTPS on every page in our nginx configuration file.</p><pre  class="line-numbers"><code class="language-nginx">server {
    listen      80;
    listen [::]:80 ipv6only=on;

    server_name example.com;

    return 301 https://$host$request_uri;
}</code></pre><p><img src=/assets/3aec24677f5f6817ba2224082fad1f66fb574664.png alt="Secure and not secure connection in browser preview" ></p><p>An asymmetric system, as <code>SSL</code> (Secure Sockets Layer) or <code>TLS</code> (Transport Layer Security), uses a <strong>public</strong> key and a <strong>private</strong> key to encrypt communications. Anything encrypted with the public key can only be decrypted by the private key and vice-versa.</p><h3>SSL certificates</h3><p>When you request a HTTPS connection to a webpage, it will initially send its SSL certificate to your web browser. This certificate contains the public key needed to begin the secure session. Based on this initial exchange, your browser and the website then initiate the <em>SSL handshake</em>. It involves the generation of shared secrets to establish a uniquely secure connection between yourself and the website.</p><p><img src=/assets/ec2613de0f5bea5569f47bcfd7379fe19883eff1.png alt="HTTPS session handshake" ></p><p>There are many companies that issue certificates for your company and are tied to a specific domain. If you want to use free services to get SSL certificate, only domain-validated certificates are being issued, since they can be fully automated.</p><h2>Configure nginx</h2><p>Fisrt, we need to define basic configuration to listen HTTPS port and turn on HTTP2:</p><pre  class="line-numbers"><code class="language-nginx">server {
    server_tokens off;

    server_name example.com;
    root        /path/to/project;
    index       index.php index.html index.htm;

    listen      443 ssl http2;
    listen [::]:443 ssl http2;

    ssl on;

    # rest config
}</code></pre><p>Directive <code>listen 443 ssl http2;</code> enables HTTP2 for us. The most crucial feature is complete multiplexing. It follows that multiple requests may occur in precisely the exact same time over a link that remains open for the length of the transport procedure.</p><p><img src=/assets/d6257a17b4cde36916a071c5126acfa0c9be7376.png alt="HTTP/1.1 vs HTTP/2" ></p><h3>Indicate certificates</h3><p>Further, specify paths to the certificates into directives <strong><code>ssl_certificate</code></strong> and <strong><code>ssl_certificate_key</code></strong>.</p><pre  class="line-numbers"><code class="language-nginx">server {
    # ...

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/key.pem;

    # rest config
}</code></pre><p>Directive <strong><code>ssl_certificate</code></strong> refers to certificate path given for your host. Intermediate certificates have to be specified in addition to a primary certificate in the following order: the primary certificate comes first, then the intermediate certificates.</p><p>If you do not have a full chain certificate, you must merge the certificate issued to your host with a CA certificate:</p><pre  class="line-numbers"><code class="language-bash">sudo cat host.crt server.ca.pem &gt; /etc/nginx/ssl/fullchain.pem</code></pre><h4>OCSP stapling</h4><p><strong>TLS Certificate Status Request</strong> extension presents a time-stamped OCSP response signed by the CA to the initial TLS handshake, thereby clients don't need to contact the CA.</p><pre  class="line-numbers"><code class="language-nginx">server {
    # ...

    ssl_stapling on;
    ssl_stapling_verify on;
    # resolver 127.0.0.1 [::1];
    resolver 8.8.8.8 8.8.4.4 208.67.222.222 208.67.220.220 valid=300s;
    resolver_timeout 10;

    # rest config
}</code></pre><p>OCSP Stapling is controlled by the <strong><code>ssl_stapling</code></strong> directive and can be enabled independently of OCSP Stapling Verification. If verification is disabled, the server simply forwards to the client the OCSP response it received from the CA, without performing any validation. Directive <strong><code>ssl_stapling_verify</code></strong> enables verification of OCSP responses by the server.</p><p>SSL Stapling allows the server to attach OCSP responses, thereby reducing the time for clients to load pages. The certificate chain (domain - intermediate authorization center - root authorization center) can contain 3-4 levels. And for each level, the browser must establish a connection and receive a certificate. You can send all the certificates (including the intermediate one, so that the certificate chain is guaranteed to fit into one package transfer) at once, then the browser will check the whole chain locally, and request only the root certificate (which in most cases is already on the client).</p><p>To make it works, it is necessary to describe the <strong><code>resolver</code></strong> directive. If you have your own DNS server raised, you can set the value to <code>127.0.0.1 [::1]</code>. If not, you can specify Google DNS servers <code>8.8.8.8 8.8.4.4</code>, or any others. <strong>But keep in mind</strong>, using Google DNS servers for OCSP stapling, it opens the door to DNS cache poisoning of the OCSP stapling mechanism by a third-party. Data centers are easy enough to identify by IP address range. So all Google has to do is verify that someone is requesting known OCSP servers, verify that the server supports OCSP stapling, and they can easily engage in an OCSP stapling MITM attack. Running BIND locally is easy to install and set up on most distributions, eg. for Debian-based you need to install it using <code>sudo apt-get install bind9</code>.</p><h4>Key Exchange</h4><p>Directive <strong><code>ssl_dhparam</code></strong> is necessary to earn Forward Secrecy. That means that if a third party recognizes a session key, it can only access data protected by that key.</p><pre  class="line-numbers"><code class="language-nginx">server {
    # ...

    ssl_dhparam /etc/nginx/ssl/dhparam.pem;

    # rest config
}</code></pre><p>To maintain perfect forward secrecy (PFS), the key used to encrypt the transmitted data should not be used to obtain any additional keys. You can generate this key locally using the following command:</p><pre  class="line-numbers"><code class="language-bash">sudo openssl dhparam -out /etc/nginx/ssl/dhparam.pem 4096</code></pre><h4>Chiphers</h4><pre  class="line-numbers"><code class="language-nginx">server {
    # ...

    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;

    ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA';

    ssl_prefer_server_ciphers on;

    # rest config
}</code></pre><p>Using <strong><code>ssl_protocols</code></strong> we are defining, that we want to use only TLS protocols instead of SSL. This is reasonably secure. However, disabling <code>TLSv1.0</code> and <code>TLSv1.1</code> gives us better score by SSL Labs checking. In <strong><code>ssl_ciphers</code></strong> directive we are disabling everything from SSL and defining ciphers we want to use. Directive <strong><code>ssl_prefer_server_ciphers</code></strong> force nginx to strictly follow only this ciphers.</p><h4>Cache session</h4><p>Maintaining SSL Sessions is definitely a good thing for everyone if you expect the user to be on your website for more than a single page view. Directive <strong><code>ssl_session_cache</code></strong> sets types and sizes of caches that store session parameters. In example below we will set 20 MB, this should be enough; and <strong><code>ssl_session_timeout</code></strong> directive sets a time during which a client may reuse the session parameters from cache.</p><pre  class="line-numbers"><code class="language-nginx">server {
    # ...

    ssl_session_cache shared:SSL:20m;
    ssl_session_timeout 60m;

    # rest config
}</code></pre><h4>Strict Transport Security</h4><p>An attacker can hijack the redirect with a tool like <code>SSLStrip</code>, and if the user is posting sensitive information then it will be leaked. You should enable <code>HSTS</code> (HTTP Strict Transport Security) to enforce HTTPS. This makes it so once a user's browser has been to your website, it will refuse to connect to the insecure version for some period of time. This isn't as nice as it could be, but it's much better than nothing.</p><pre  class="line-numbers"><code class="language-nginx">server {
    # ...

    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;

    # rest config
}</code></pre><p><strong>Strict-Transport-Security</strong> response header tells browsers how long they need to remember the security requirements for our domain. In this case - 1 year, including subdomains. <code>preload</code> is not part of the HSTS specification and should not be treated as official, but nevertheless, browsers will never connect to your domain using an insecure connection.</p><p><strong>Be careful</strong> with <code>includeSubDomains</code> flag! Sometimes certificates are issued for a limited number of subdomains, so only those have trusted certificates will work. Or you can avoid <code>includeSubDomains</code> flag to be included in the header.</p><h4>Content Security Policy (CSP)</h4><pre  class="line-numbers"><code class="language-nginx">server {
    # ...

    add_header Content-Security-Policy-Report-Only "default-src https:; script-src https: 'unsafe-eval' 'unsafe-inline'; style-src https: 'unsafe-inline'; img-src https: data:; font-src https: data:; report-uri /csp-report";

    # rest config
}</code></pre><p>Content Security Policy is the standard that defines the HTTP headers <code>Content-Security-Policy</code> and <code>Content-Security-Policy-Report-Only</code>, which inform the browser of the whitelist of hosts from which it can download various resources.</p><h3>Putting it all together</h3><p>Eventually we get the following configuration file:</p><pre  class="line-numbers"><code class="language-nginx">server {
    server_tokens off;

    server_name example.com;
    root        /path/to/project;
    index       index.php index.html index.htm;

    listen      443 ssl http2;
    listen [::]:443 ssl http2;

    ssl on;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/key.pem;

    ssl_stapling on;
    ssl_stapling_verify on;
    resolver 8.8.8.8 8.8.4.4 208.67.222.222 208.67.220.220 valid=300s;
    resolver_timeout 10;

    ssl_dhparam /etc/nginx/ssl/dhparam.pem;

    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;

    ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA';

    ssl_prefer_server_ciphers on;

    ssl_session_cache shared:SSL:20m;
    ssl_session_timeout 60m;

    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;
    add_header Content-Security-Policy-Report-Only "default-src https:; script-src https: 'unsafe-eval' 'unsafe-inline'; style-src https: 'unsafe-inline'; img-src https: data:; font-src https: data:; report-uri /csp-report";

    # rest config
}</code></pre><p>As a result, we will get A+ score from SSL Labs:</p><p><img src=/assets/8868d5b5a01fd2d2ed3873b82c853444aa90c842.png alt="SSL Labs score A+" ></p><hr><div class="resources collapsable-block non-printable"><p class="collapsable"><i class="fa fa-arrow-circle-right arrow"></i><strong>Resources</strong><i class="fa fa-fw fa-info-circle info"><span class="tooltip-box">Click to expand/shrink</span></i></p><ol class="page_speed_501768847"><li><i class="fa fa-fw fa-file-text link-type-icon"></i><a href="https://habr.com/post/252821/" target="_blank" rel="nofollow">Nginx и https. Получаем класс А+ </a> (Russian) </li><li><i class="fa fa-fw fa-file-text link-type-icon"></i><a href="https://weakdh.org/sysadmin.html" target="_blank" rel="nofollow">Guide to Deploying Diffie-Hellman for TLS </a></li><li><i class="fa fa-fw fa-file-text link-type-icon"></i><a href="https://www.html5rocks.com/en/tutorials/security/content-security-policy/" target="_blank" rel="nofollow">An Introduction to Content Security Policy </a></li><li><i class="fa fa-fw fa-file-text link-type-icon"></i><a href="https://www.ssllabs.com/ssltest/analyze.html" target="_blank" rel="nofollow">SSL security checker </a></li></ol></div></div><div class="post-meta post-footer"><span class="post-footer-tags tags"><i class="fa fa-fw fa-tags"></i><a href="#">#tutorial</a><a href="#">#nginx</a><a href="#">#security</a><a href="#">#https</a><a href="#">#ssl-certificate</a><a href="#">#network</a><a href="#">#ssl</a><a href="#">#tsl</a><a href="#">#http</a><a href="#">#server</a><a href="#">#web</a><a href="#">#cipher</a><a href="#">#system-administration</a><a href="#">#session</a></span><div class="author"></div><div class="post-actions-wrap non-printable"><nav><ul class="post-actions post-action-nav"></ul></nav><ul class="post-actions post-action-share"><li class="post-action"><a class="post-shares post-action-btn btn btn--default" target="_blank" href="//plus.google.com/share?url=/network/security-class-a-with-nginx-https" ><i class="fa fa-google-plus"></i></a></li><li class="post-action"><a class="post-shares post-action-btn btn btn--default" target="_blank" href="//www.facebook.com/sharer/sharer.php?u=/network/security-class-a-with-nginx-https&title=Obtaining+security+class+A%2B+with+nginx+and+https" ><i class="fa fa-facebook-official"></i></a></li><li class="post-action"><a class="post-shares post-action-btn btn btn--default" target="_blank" href="//twitter.com/intent/tweet?text=Obtaining security class A+ with nginx and https&url=/network/security-class-a-with-nginx-https&via=@LarapulseT" ><i class="fa fa-twitter"></i></a></li></ul></div><div id="bottom-bar" class="post-bottom-bar" data-behavior="1"><div class="post-actions-wrap non-printable"><nav><ul class="post-actions post-action-nav"></ul></nav><ul class="post-actions post-action-share"><li class="post-action"><a class="post-shares post-action-btn btn btn--default" target="_blank" href="//plus.google.com/share?url=/network/security-class-a-with-nginx-https" ><i class="fa fa-google-plus"></i></a></li><li class="post-action"><a class="post-shares post-action-btn btn btn--default" target="_blank" href="//www.facebook.com/sharer/sharer.php?u=/network/security-class-a-with-nginx-https&title=Obtaining+security+class+A%2B+with+nginx+and+https" ><i class="fa fa-facebook-official"></i></a></li><li class="post-action"><a class="post-shares post-action-btn btn btn--default" target="_blank" href="//twitter.com/intent/tweet?text=Obtaining security class A+ with nginx and https&url=/network/security-class-a-with-nginx-https&via=@LarapulseT" ><i class="fa fa-twitter"></i></a></li></ul></div></div></div></article><div class="back-top-wrapper non-printable"><div class="top-btn"><i class="arrow-up"></i></div></div></section><footer id="footer" class="main-content-wrap"><nav class="non-printable"><a href="/data-protection/privacy-policy">Privacy policy</a><a href="/data-protection/cookie-policy">Cookie policy</a></nav><span class="copyrights"> Copyrights &copy; 2025 <a href="https://podgornyy.rocks" target="_blank">Sergey Podgornyy</a>. All Rights Reserved. <br> Designed by <a href="http://louisbarranqueiro.github.io/hexo-theme-tranquilpeak/" target="_blank">Louis Barranqueiro</a></span><span class="socials"><a href="https://www.youtube.com/channel/UC3wminGFli412MBDKkdUufQ" target="_blank" title="Larapulse at YouTube"><i class="fa fa-youtube-play fa-fw"></i></a><a href="https://www.instagram.com/larapulse.technology/" target="_blank" title="Larapulse at Instagram"><i class="fa fa-instagram fa-fw"></i></a><a href="https://www.facebook.com/larapulse/" target="_blank" title="Larapulse at Facebook"><i class="fa fa-facebook-square fa-fw"></i></a><a href="https://www.linkedin.com/company/larapulse/" target="_blank" title="Larapulse at LinkedIn"><i class="fa fa-linkedin-square fa-fw"></i></a><a href="https://twitter.com/LarapulseT" target="_blank" title="Larapulse at Twitter"><i class="fa fa-twitter fa-fw"></i></a><a href="http://t.me/larapulse" target="_blank" title="Larapulse at Telegram"><i class="fa fa-telegram fa-fw"></i></a></span></footer></div></div><div id="about" class="popup-full non-printable page_speed_497134828"><div id="about-card" class="page_speed_536648213"><div id="about-btn-close"><i class="fa fa-remove"></i></div><img id="about-card-picture" src=/assets/larapulse_logo_250.png><h4 id="about-card-name">Larapulse Technology Blog</h4><h5 id="about-card-bio"><p> Information Technology blog and group of developers interesting in modern technologies, well-written code and further education </p></h5><h5 id="about-card-job"><i class="fa fa-university"></i><br><p>Founded at 2017</p></h5><h5 id="about-card-location"><i class="fa fa-map-marker"></i><br><p>Germany</p></h5></div></div><div id="cover"></div><script src=/assets/main.4065552450.js></script><div id="gdpr-modal" class="hidden non-printable"><div class="gdpr-modal-inner-wrap"><div class="gdpr-modal-inner"><div id="gdpr-modal-main" class=""><h2>Have a Cookie? :)</h2><img src=/assets/cookie.png alt="cookies"><p> Our site uses cookies to provide functionality and performance as well as for social media and advertising purposes. Social media and advertising cookies of third parties are used to offer you social media functionalities and personalized ads for Larapulse Technology content and offers. To get more information about these cookies and how we process personal data, check our <a href="/data-protection/privacy-policy" target="_blank">Privacy Policy</a>. Do you accept the use of cookies and the processing of personal data involved? </p><div class="button-wrap"><button class="gdpr-button button-secondary" onclick="gdpr_show_more_info()">More Information</button><button class="gdpr-button button-primary" onclick="gdpr_accept()" id="gdpr-accept-btn">Yes, I accept</button></div></div><div id="gdpr-modal-more-info" class="hidden"><h2>Your Cookie Settings</h2><form><div class="gdpr-modal-checkbox"><input type=checkbox id="gdpr-func-checkbox" value="yes" checked="checked" disabled><label for="gdpr-func-checkbox">Site functionality and performance</label></div><p> These cookies are required for Larapulse Technology site functionality and are therefore always enabled. These include cookies that allow you to be remembered as you explore the Larapulse Technology site, help make the shopping cart and checkout process possible as well as assist in security issues and conforming to regulations. To use the Larapulse Technology website, you have to consent to these cookies and the processing of personal data according to the Larapulse Technology website terms of use and privacy policy. </p><div class="gdpr-modal-checkbox"><input type=checkbox id="gdpr-social-checkbox" value="yes" checked=""><label for="gdpr-social-checkbox">Social media and advertising</label></div><p> Social media cookies offer the possibility to connect you to your social networks and share content from our website through social media. Advertising cookies (of third parties) collect information to help better tailor Larapulse Technology advertising to your interests, both within and beyond Larapulse Technology websites. De-selecting these cookies may result in seeing advertising that is not as relevant to you or you not being able to link effectively with Facebook, Twitter, or other social networks and/or not allowing you to share content on social media. </p></form><div class="button-wrap"><button onclick="gdpr_hide_more_info()" class="gdpr-button button-primary">Back</button></div></div></div></div></div><script> "use strict"; var domain = 'larapulse.com'; var GDPR, GDPR_FUNCTIONAL_COOKIE_CONSENT = "no", GDPR_SOCIAL_COOKIE_CONSENT = "no"; function gdpr_accept() { GDPR.userAccept(); } function gdpr_show_more_info() { GDPR.hideElement("gdpr-modal-main"); GDPR.showElement("gdpr-modal-more-info"); } function gdpr_hide_more_info() { GDPR.hideElement("gdpr-modal-more-info"); GDPR.showElement("gdpr-modal-main"); } function should_use_functional_cookie() { return "yes" == GDPR_FUNCTIONAL_COOKIE_CONSENT; } function should_use_social_cookie() { return "yes" == GDPR_SOCIAL_COOKIE_CONSENT; } function show_cookies_settings() { GDPR.showPopup(); gdpr_show_more_info(); } (GDPR = { functional_cookie_consent: !1, social_cookie_consent: !1, opinionGiven: !1, clickedFormObj: null, formChecked: !1, init: function() { this.checkConsent(); !0 === this.opinionGiven || this.isEuCountry() && (window.onload = function() { "/data-protection/privacy-policy" !== window.location.pathname && "/data-protection/cookie-policy" !== window.location.pathname && GDPR.showPopup() } ) }, checkConsent: function() { var o = this.getCookie("functional_cookie_consent"), t = this.getCookie("social_cookie_consent"); "" !== o || "" !== t ? ( this.opinionGiven = !0, "yes" === o && ( this.functional_cookie_consent = !0, GDPR_FUNCTIONAL_COOKIE_CONSENT = "yes" ), "yes" === t && ( this.social_cookie_consent = !0, GDPR_SOCIAL_COOKIE_CONSENT = "yes" ) ) : this.isEuCountry() || (GDPR_SOCIAL_COOKIE_CONSENT = GDPR_FUNCTIONAL_COOKIE_CONSENT = "yes") }, setConsent: function(o, t) { "yes" !== (t = void 0 === t ? "yes" : t) && "no" !== t || ("both" === o ? (this.setCookie("functional_cookie_consent", t, 129600), this.setCookie("social_cookie_consent", t, 129600), this.updateFormSocialConsentField(t), this.updateFormFunctionalConsentField(t)) : ("social" === o && (this.setCookie("social_cookie_consent", t, 129600), this.updateFormSocialConsentField(t)), "functional" === o && (this.setCookie("functional_cookie_consent", t, 129600), this.updateFormFunctionalConsentField(t))), this.checkConsent()) }, deleteConsent: function(o) { "both" === o ? (this.deleteCookie("functional_cookie_consent"), this.deleteCookie("social_cookie_consent")) : "functional " === o ? this.deleteCookie("functional_cookie_consent") : "social" === o && this.deleteCookie("social_cookie_consent") }, userAccept: function() { if (!0 === document.getElementById("gdpr-social-checkbox").checked ? this.setConsent("both", "yes") : (this.setConsent("social", "no"), this.setConsent("functional", "yes")), null !== this.clickedFormObj) { this.checkConsent(); var o = this.clickedFormObj; this.formChecked = !0, o.find(".mktf_submit_button").first().trigger("click"), this.hidePopup() } else document.getElementById("gdpr-accept-btn").disabled = !0, location.reload() }, updateFormSocialConsentField: function(o) { null !== this.clickedFormObj && this.clickedFormObj.find(".mktf_Cookie_Opt_In__c").first().val(o) }, updateFormFunctionalConsentField: function(o) { null !== this.clickedFormObj && this.clickedFormObj.find(".mktf_Functional_Cookie_Opt_In__c").first().val(o) }, showPopup: function() { "no" === this.getCookie("social_cookie_consent") && (document.getElementById("gdpr-social-checkbox").checked = !1), this.showElement("gdpr-modal") }, hidePopup: function() { this.hideElement("gdpr-modal") }, showElement: function(o) { var t = document.getElementById(o); this.removeClass(t, "hidden") }, hideElement: function(o) { var t = document.getElementById(o); this.addClass(t, "hidden") }, hasClass: function(o, t) { return o.classList ? o.classList.contains(t) : !!o.className.match(new RegExp("(\\s|^)" + t + "(\\s|$)")) }, addClass: function(o, t) { o.classList ? o.classList.add(t) : this.hasClass(o, t) || (o.className += " " + t) }, removeClass: function(o, t) { if (o.classList) o.classList.remove(t); else if (this.hasClass(o, t)) { var e = new RegExp("(\\s|^)" + t + "(\\s|$)"); o.className = o.className.replace(e, " ") } }, setCookie: function(o, t, e) { var i = ""; if (null != e) { i = "; expires=" + (i = new Date((new Date).getTime() + 36e5 * e)).toGMTString(); var n = "; path=/" } document.cookie = o + "=" + escape(t) + i + n }, getCookie: function(o) { var t = "" , e = o + "="; if (0 < document.cookie.length) { var i = document.cookie.indexOf(e); if (-1 !== i) { i += e.length; var n = document.cookie.indexOf(";", i); -1 === n && (n = document.cookie.length), t = unescape(document.cookie.substring(i, n)) } } return t }, deleteCookie: function(o) { document.cookie = o + "=; expires=Thu, 01 Jan 1970 00:00:01 GMT; domain="+domain+";" }, isEuCountry: function(o) { /** TODO */ return true; if ("" === (o = void 0 === o ? "" : o)) { var t = GDPR.getCookie("geoip"); if ("" !== t) o = t.split(",")[0] } return "" !== o && -1 !== ["AT", "BE", "BG", "HR", "CY", "CZ", "DK", "EE", "FI", "FR", "DE", "GR", "HU", "IE", "IT", "LV", "LT", "LU", "MT", "NL", "PL", "PT", "RO", "SK", "ES", "SE", "GB"].indexOf(o) } }).init();</script></body></html>